# Directory of *this* script
$this_dir = Split-Path -Parent $MyInvocation.MyCommand.Path

$base_dir = (Resolve-Path "$this_dir\..").Path

# Path to virtual environment
$venv = "$base_dir\.venv"

if (Test-Path $venv) {
    # Activate virtual environment if available
    & $venv\Scripts\Activate
}

if ($args.Count -eq 0) {
    Write-Host "
    
 ██▒   █▓ ▄▄▄       █    ██  ██▓  ▄▄▄█████▓   ▓█████▄ ▓█████  ▄████▄   ██▀███ ▓██   ██▓ ██▓███  ▄▄▄█████▓ ▒█████   ██▀███  
▓██░   █▒▒████▄     ██  ▓██▒▓██▒  ▓  ██▒ ▓▒   ▒██▀ ██▌▓█   ▀ ▒██▀ ▀█  ▓██ ▒ ██▒▒██  ██▒▓██░  ██▒▓  ██▒ ▓▒▒██▒  ██▒▓██ ▒ ██▒
 ▓██  █▒░▒██  ▀█▄  ▓██  ▒██░▒██░  ▒ ▓██░ ▒░   ░██   █▌▒███   ▒▓█    ▄ ▓██ ░▄█ ▒ ▒██ ██░▓██░ ██▓▒▒ ▓██░ ▒░▒██░  ██▒▓██ ░▄█ ▒
  ▒██ █░░░██▄▄▄▄██ ▓▓█  ░██░▒██░  ░ ▓██▓ ░    ░▓█▄   ▌▒▓█  ▄ ▒▓▓▄ ▄██▒▒██▀▀█▄   ░ ▐██▓░▒██▄█▓▒ ▒░ ▓██▓ ░ ▒██   ██░▒██▀▀█▄  
   ▒▀█░   ▓█   ▓██▒▒▒█████▓ ░██████▒▒██▒ ░    ░▒████▓ ░▒████▒▒ ▓███▀ ░░██▓ ▒██▒ ░ ██▒▓░▒██▒ ░  ░  ▒██▒ ░ ░ ████▓▒░░██▓ ▒██▒
   ░ ▐░   ▒▒   ▓▒█░░▒▓▒ ▒ ▒ ░ ▒░▓  ░▒ ░░       ▒▒▓  ▒ ░░ ▒░ ░░ ░▒ ▒  ░░ ▒▓ ░▒▓░  ██▒▒▒ ▒▓▒░ ░  ░  ▒ ░░   ░ ▒░▒░▒░ ░ ▒▓ ░▒▓░
   ░ ░░    ▒   ▒▒ ░░░▒░ ░ ░ ░ ░ ▒  ░  ░        ░ ▒  ▒  ░ ░  ░  ░  ▒     ░▒ ░ ▒░▓██ ░▒░ ░▒ ░         ░      ░ ▒ ▒░   ░▒ ░ ▒░
     ░░    ░   ▒    ░░░ ░ ░   ░ ░   ░          ░ ░  ░    ░   ░          ░░   ░ ▒ ▒ ░░  ░░         ░      ░ ░ ░ ▒    ░░   ░ 
      ░        ░  ░   ░         ░  ░             ░       ░  ░░ ░         ░     ░ ░                           ░ ░     ░     
     ░                                         ░             ░                 ░ ░                                         

    "
    python -m vault_decryptor -h
} else {
    python -m vault_decryptor $args
}